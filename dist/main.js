(()=>{"use strict";function e(e){let t=[];return{getName:()=>e,setName:t=>e=t,getTask:e=>t.find((t=>t.getTitle()===e)),getTasks:()=>t,addTask:e=>{const n=e.getTitle();t.some((e=>e.getTitle()===n))?alert("A task with the same title already exists, please try with a different name."):t.push(e)},getTomorrowsTasks:()=>t.filter((e=>(e=>{const t=new Date;return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()-1===t.getDate()})(e.getDueDate()))),deleteTask:e=>{t.splice(t.indexOf(e),1)}}}function t(e,t,n,a){return{getDescription:()=>t,getDueDate:()=>n,getPriority:()=>a,getTitle:()=>e,setTitle:t=>e=t,setDescription:e=>t=e,setDueDate:e=>n=e,setPriority:e=>a=e}}const n=function(){let n=[];const a=e=>{const t=e.getName();n.some((e=>e.getName()===t))?alert("A Project with the same name already exists, please try with a different name."):n.push(e)};return{getProject:e=>n.find((t=>t.getName()===e)),getProjects:()=>n,addProject:a,deleteProject:e=>{n.splice(n.indexOf(e),1)},saveProjects:()=>{const e=n.map((e=>{const t=e.getTasks().map((e=>({title:e.getTitle(),description:e.getDescription(),dueDate:{year:e.getDueDate().getFullYear(),month:e.getDueDate().getMonth(),day:e.getDueDate().getDate()},priority:e.getPriority()})));return{name:e.getName(),tasks:t}}));localStorage.setItem("todoList",JSON.stringify(e))},getProjectsFromStorage:()=>{const n=JSON.parse(localStorage.getItem("todoList"));console.log(n),n.forEach((n=>{const o=e(n.name);return n.tasks.forEach((e=>{const n=t(e.title,e.description,new Date(e.dueDate.year,e.dueDate.month,e.dueDate.day),e.priority);o.addTask(n)})),a(o)}))}}}(),a=function(){let a;const o=document.createElement("div");o.id="tasks-container";const i=document.createElement("header"),r=e=>{if("task-div"==e.target.className)"none"===(t=e.path[1].children[1]).style.display?t.style.display="grid":t.style.display="none";else{if("task-div"!==e.target.parentNode.className)return;{const t=a.getTask(e.path[1].innerText);"fas fa-pen edit-task-button"===e.target.className?c(t):(a.deleteTask(t),n.saveProjects(),d())}}var t},d=()=>{o.innerHTML="",a.getTasks().forEach((e=>{const t=document.createElement("div");t.className="task-container",t.innerHTML=`<div class="task-div"><input type="checkbox">${e.getTitle()}<i class="fas fa-pen edit-task-button"></i></div>`,t.children[0].addEventListener("click",r);const n=document.createElement("div");n.className="info";const a={title:e.getTitle(),description:e.getDescription(),dueDate:e.getDueDate(),priority:e.getPriority()},i=document.createElement("div");i.innerHTML=`<span>Title: </span>${a.title}`;const d=document.createElement("div");d.innerHTML=`<span>Description: </span>${a.description}`;const s=document.createElement("div");s.innerHTML=`<span>Due Date: </span>${a.dueDate.getDate()}/${a.dueDate.getMonth()+1}/${a.dueDate.getFullYear()}`;const c=document.createElement("div");c.innerHTML=`<span>Priority: </span>${a.priority}`,n.appendChild(i),n.appendChild(d),n.appendChild(s),n.appendChild(c),t.appendChild(n),o.appendChild(t)}));const e=document.createElement("button");e.innerText="Add Task +",e.addEventListener("click",(()=>c())),o.appendChild(e)},s=e=>{window.addEventListener("mouseup",(t=>{t.target!=e&&t.target.parentNode!=e&&e.remove()}))},c=e=>{console.log(a.getName());const i=document.createElement("form"),r=document.createElement("h3"),c=document.createElement("label");c.innerText="Title";const l=document.createElement("input"),p=document.createElement("label");p.innerText="Description";const m=document.createElement("textarea"),u=document.createElement("label");u.innerText="Due Date";const g=document.createElement("input");g.type="date";const h=document.createElement("label");h.innerText="Priority";const T=document.createElement("select"),D=document.createElement("option");D.innerText="None",D.value="none";const v=document.createElement("option");v.innerText="High",v.value="high";const E=document.createElement("option");E.innerText="Medium",E.value="medium";const f=document.createElement("option");if(f.innerText="Low",f.value="low",e){r.innerText="Edit Task",l.value=e.getTitle(),m.value=e.getDescription();const t=e.getDueDate();g.valueAsDate=new Date(t.getFullYear(),t.getMonth(),t.getDate()),[D,v,E,f].find((t=>t.value===e.getPriority().toLowerCase())).selected=!0}else r.innerText="New Task",D.selected=!0;const k=document.createElement("button");k.innerText="Add Task",k.addEventListener("click",(o=>{if(o.preventDefault(),e)e.setTitle(l.value),e.setDescription(m.value),e.setDueDate(new Date(g.valueAsDate.toUTCString())),e.setPriority(T.value);else{const e=t(l.value,m.value,new Date(g.valueAsDate),T.value);a.addTask(e),console.log(a.getTasks())}n.saveProjects(),d(),i.remove()})),s(i),T.appendChild(D),T.appendChild(v),T.appendChild(E),T.appendChild(f),i.appendChild(r),i.appendChild(c),i.appendChild(l),i.appendChild(p),i.appendChild(m),i.appendChild(u),i.appendChild(g),i.appendChild(h),i.appendChild(T),i.appendChild(k),o.appendChild(i)},l=t=>{console.log(t);const a=document.createElement("form"),o=document.createElement("h3"),r=document.createElement("input"),d=document.createElement("button");t?(o.innerText=t.getName(),d.innerText="Save",r.value=t.getName()):(o.innerText="New Project",d.innerText="Add"),d.addEventListener("click",(o=>{o.preventDefault(),t?t.setName(r.value):n.addProject(e(r.value)),m(),a.remove()})),s(a),a.appendChild(o),a.appendChild(r),a.appendChild(d),i.appendChild(a)},p=e=>{if("project-container"===e.target.className){const t=n.getProject(e.target.innerText);return a=n.getProject(t.getName()),""===o.innerHTML||(o.innerHTML=""),d(t.getName())}{const t=n.getProject(e.path[1].innerText);"fas fa-trash-alt delete-project-button"===e.target.className?(n.deleteProject(t),n.saveProjects(),m()):"fas fa-pen edit-project-button"===e.target.className&&l(t)}},m=()=>{i.innerHTML="";const e=document.createElement("button");e.innerText="+ Add Project",e.id="add-project",e.addEventListener("click",(()=>l())),n.getProjects().forEach((e=>{const t=document.createElement("div");t.innerText=e.getName(),t.className="project-container",t.addEventListener("click",p);const n=document.createElement("i");n.className="fas fa-pen edit-project-button";const a=document.createElement("i");a.className="fas fa-trash-alt delete-project-button",t.appendChild(n),t.appendChild(a),i.appendChild(t)})),i.appendChild(e)};return{loadHomePage:()=>{document.body.appendChild(i),document.body.appendChild(o)},loadHeader:m,loadTasks:d}}();n.getProjectsFromStorage(),console.log(n.getProjects()),a.loadHomePage(),a.loadHeader()})();